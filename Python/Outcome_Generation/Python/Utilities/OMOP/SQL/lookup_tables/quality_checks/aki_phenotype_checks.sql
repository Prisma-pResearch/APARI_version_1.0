SELECT 
	[concept_id],
    [concept_code],
    [concept_name],
    [vocabulary_id],
	concept_class_id,
    [domain_id],
	[ancestor_concept_id],
	'esrd' [variable_name]
FROM 
	VOCAB.CONCEPT c
	INNER JOIN VOCAB.CONCEPT_ANCESTOR ca on ca.descendant_concept_id = c.concept_id
WHERE
	standard_concept = 'S'
	AND
	ca.ancestor_concept_id IN (193782) -- End-stage renal disease SNOMED
								--36716946)  -- Acute renal insufficiency SNOMED
								
GO

-- GOOD
--aki_codes = ['584','584.5','584.6','584.7','584.8','584.9','997.5','N17','N17.0',
--             'N17.1','N17.2','N17.8','N17.9','N28.9','593.9']


-- Some of these codes are for chronic kidney dysfunction, but not necessarily CKD. Need to clarify whether to include or not
--ckd_codes=['N01.8', 'N01.9', 'N01.4', 'N01.5', 'N01.6', 'N01.7', 'N01.0', 'N01.1', 'N01.2',
--           'N01.3', 'E08.2', '582.89', 'E13.2', 'Q61.9', '582.81', 'N07.8', 'N07.9', 'N07.2',
--           'N07.3', 'N07.0', 'N07.1', 'N07.6', 'N07.7', 'N07.4', 'N07.5', 'E08.21', 'E08.22', 'Q61.8', 'E08.29',
--           'N05.8', 'N05.9', 'N05.0', 'N05.1', 'N05.2', 'N05.3', 'N05.4', 'N05.5', 'N05.6', 'N05.7', 'N03.8', 'N03.9',
--           'N03.6', 'N03.7', 'N03.4', 'N03.5', 'N03.2', 'N03.3', 'N03.0', 'N03.1', '586', '403.10', '403.11', 'I13.10',
--           'I13.11', '581.3', '581.2', '581.1', '581.0', '403.01', '581.9', '581.8', '403.00', 'E11.29', 'N25.89',
--           'E11.22', 'E11.21', '583.6', 'N25.81', 'N05', 'N04', 'N07', 'N06', 'N01', 'N03', '583.1', '583.0', '585',
--           '582','583.4', '583.7', '581', '583.9', '583.8', 'Q61.3', 'Q61.2', 'Q61.5', 'Q61.4', 'I12.9', '588.8',
--           '588.9', 'I12.0', 'N28.0', '585.9', '585.4', '585.3', '585.2', '585.1', '403.91', 'N18.9', '250.43',
--           '250.42', '250.41', '250.40', '404.00', '404.01', '404.02', '404.03', 'N18.2', 'N28', '404.11', '582.4',
--           '582.5','N18.1', '582.0', '582.1', '582.2', '582.8', '582.9', 'E10.21', 'E10.22', '583.81', '404.13',
--           '404.12', '588.89', '404.10', 'E10.29', '583.89', '588.81', '581.89', 'I13.2', '581.81', 'I13.0', 'I13.1',
--           'N25', '404.93', '404.92', '404.91', '404.90', 'E09.29', 'E09.22', 'N18.3', 'E09.21', 'N18.4', 'N18.5',
--           'E09.2', 'E11.2', 'N06.7', 'N06.6', 'N06.5', 'N06.4', 'N06.3', 'N06.2', 'N06.1', 'N06.0', 'N02.9', 'N06.9',
--           'N06.8', 'N04.5', 'N04.4', 'N04.7', 'N04.6', 'N04.1', 'N04.0', 'N04.3', 'N04.2', '753.13', 'E13.22',
--           'N04.9', 'N04.8', 'E13.29', '583.2', 'E10.2', 'Q61', 'E13.21', '583', 'N02.8', '403.90',
--           'N25.8', 'N25.9', 'N02.3', 'N02.2', 'N02.1', 'N02.0', 'N02.7', 'N02.6', 'N02.5', 'N02.4']


--dialysis_codes=['V45.12', 'V56.0', 'V56.8', 'V56.1', 'V56.2', 'V56.32', 'V45.1', 'V45.11', '996.56',
--                '996.68', '792.5', '39.95', '54.98', 'Z91.15', 'Z49.31','Z49.32', 'Z49.01', 'Z49.02',
--                'Z49.32', 'T85.71XA', 'T85.611A', 'T85.621A', 'R88.0', 'T85.631A', 'T85.71XA', 'T85.71XS',
--                'Z99.2', 'T85.71XD', 'Z99.2', '5A1D00Z ', '5A1D60Z', '3E1M39Z', '90935', '90937',
--                '90945', '90947', '90999', '5A1D70Z', '5A1D80Z', '5A1D90Z']

--transplant_codes=['V42.0', '996.81', '55.6', '55.61', '55.69', 'Z94.0', 'T86.10', 'T86.11',
--                  'T86.12', 'T86.13', 'T86.19', '0TS00ZZ', '0TS10ZZ', '0TY00Z0', '0TY00Z1',
--                  '0TY10Z0', '0TY10Z1', '50360','50365', '50380']

--esrd_basic_codes = ['585.6','V45.1','V45.11','V45.12','N18.6','Z91.15','Z99.2']
--esrd_dialysis_codes = ['585.5','N18.5']
--esrd_dialysis_aki_codes=['N01.8', 'N01.9', 'N01.4', 'N01.5', 'N01.6', 'N01.7', 'N01.0', 'N01.1', 'N01.2', 'N01.3',
--                         'E08.2', '582.89', 'E13.2', 'Q61.9', '582.81', 'N07.8', 'N07.9', 'N07.2', 'N07.3', 'N07.0',
--                         'N07.1', 'N07.6', 'N07.7', 'N07.4', 'N07.5', 'E08.21', 'E08.22', 'Q61.8', 'E08.29', 'N05.8',
--                         'N05.9', 'N05.0', 'N05.1', 'N05.2', 'N05.3', 'N05.4', 'N05.5', 'N05.6', 'N05.7', 'N03.8',
--                         'N03.9', 'N03.6', 'N03.7', 'N03.4', 'N03.5', 'N03.2', 'N03.3', 'N03.0', 'N03.1', '586',
--                         '403.10', '403.11', 'I13.10', 'I13.11', '581.3', '581.2', '581.1', '581.0', '403.01', '581.9',
--                         '581.8', '403.00', 'E11.29', 'N25.89', 'E11.22', 'E11.21', '583.6', 'N25.81', 'N05', 'N04',
--                         'N07', 'N06', 'N01', 'N03', '583.1', '583.0', '585', '582', '583.4', '583.7', '581', '583.9',
--                         '583.8', 'Q61.3', 'Q61.2', 'Q61.5', 'Q61.4', 'I12.9', '588.8', '588.9', 'I12.0', 'N28.0',
--                         '585.9', '585.4', '585.3', '585.2', '585.1', '403.91', 'N18.9', '250.43', '250.42',
--                         '250.41', '250.40', '404.00', '404.01', '404.02', '404.03', 'N18.2', 'N28', '404.11',
--                         '582.4', '582.5', 'N18.1', '582.0', '582.1', '582.2', '582.8', '582.9', 'E10.21', 'E10.22',
--                         '583.81', '404.13', '404.12', '588.89', '404.10', 'E10.29', '583.89', '588.81', '581.89',
--                         'I13.2', '581.81', 'I13.0', 'I13.1', 'N25', '404.93', '404.92', '404.91', '404.90', 'E09.29',
--                         'E09.22', 'N18.3', 'E09.21', 'N18.4', 'N18.5', 'E09.2', 'E11.2', 'N06.7', 'N06.6', 'N06.5',
--                         'N06.4', 'N06.3', 'N06.2', 'N06.1', 'N06.0', 'N02.9', 'N06.9', 'N06.8', 'N04.5', 'N04.4',
--                         'N04.7', 'N04.6', 'N04.1', 'N04.0', 'N04.3', 'N04.2', '753.13', 'E13.22', 'N04.9', 'N04.8',
--                         'E13.29', '583.2', 'E10.2', 'Q61', 'E13.21', '583', 'N02.8', '403.90', 'N25.8',
--                         'N25.9', 'N02.3', 'N02.2', 'N02.1', 'N02.0', 'N02.7', 'N02.6', 'N02.5', 'N02.4']